#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ”¨ Running builds before push..."

# Web build test
echo "ğŸ“± Testing web build..."
pnpm build:web
if [ $? -ne 0 ]; then
  echo "âŒ Web build failed!"
  exit 1
fi
echo "âœ… Web build successful!"

# Native Android build test
echo "ğŸ¤– Testing Android build..."
pnpm --filter career-native run android --no-bundler
if [ $? -ne 0 ]; then
  echo "âŒ Android build failed!"
  exit 1
fi
echo "âœ… Android build successful!"

# Native iOS build test (only on macOS)
if [[ "$OSTYPE" == "darwin"* ]]; then
  echo "ğŸ Testing iOS build..."
  pnpm --filter career-native run ios --no-bundler
  if [ $? -ne 0 ]; then
    echo "âŒ iOS build failed!"
    exit 1
  fi
  echo "âœ… iOS build successful!"
else
  echo "â„¹ï¸ Skipping iOS build (not on macOS)"
fi

echo "ğŸ‰ All builds passed!"